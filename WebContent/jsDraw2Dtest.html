<!DOCTYPE html>
<html>


<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
<style>
	body {
		width: 1000px;
  		margin: 0 auto;
	}
	#canvas {
		margin-top: 50px;
		margin-left: 0px;
		margin-right: 0px;
		padding: 0;
		overflow:hidden;
		position:relative;
		width:1000px;
		height:400px;
		border:#999999 1px solid;
	}
</style>
<script type="text/JavaScript" src="lib/jsDraw2D.js"></script>
</head>


<body>

<div id="canvas"></div>

<br><br><br><br>

<script type="text/javascript">
	var eventQueueX=[][], // 첫번째 첨자 : 사람 / 두번째 첨자 : x의 데이터 인덱스
		eventQueueY=[][],// 첫번째 첨자 : 사람 / 두번째 첨자 : y의 데이터 인덱스
		maxData=20, // 최대 저장 가능한 데이터 갯수.
		dataIndex=0, //현재 데이터 index.
		personNo=0, // 사람 수.
		maxPerson=0, //최대 사람 수. 일단 필요할 것 같아서 선언해둠.
		id=[], // id
		x=0, // x좌
		y=0; // y좌
	

	var canvasWidth = $('#canvas').outerWidth(true);
	
    var realSize = prompt("가로/세로 값을 미터(m) 단위로 입력하세요.(가로/세로)", "");
    if (realSize != null) {
    	var input = realSize.split("/");
    	var canvasHeight = input[1] * canvasWidth / input[0];
    	$('#canvas').css('height', canvasHeight+'px');
    	initCanvas(canvasWidth/2, canvasHeight/2, input[0]/2);
    }
    var gr;
    
    window.onload=function(){
   	 var canvas = document.getElementById('mycanvas');
   		setInterval(function(){ 
   			$.ajax({
   				url:"test",
   				type: "get",
   				success : function(data) {
   					if (data) {
   						maxPerson = data.split(",")[0];
   						for(var i=1;i<=maxPerson;i++) {
   							id[i-1]=data.split(",")[3*i-2]; // 3n-2
   							x = data.split(",")[3*i-1]; // 3n-1
   							y = data.split(",")[3*i]; // 3n
   							eventQueueX[i-1][dataIndex++%maxData]= x ;
   							eventQueueY[i-1][dataIndex++%maxData]= y ;
   							
   							drawCoordinate(id[i-1], x*100, y*100);
   						} // for문 종료.
   					} //if문 종료.
   			     } //success 종료.
   			});
   		}, 500);
   		
    }
    
    var font=new jsFont("arial","bold","12px");
    function initCanvas(w, h, realX) {	
    	var range = w/realX;
        
    	gr=new jsGraphics(document.getElementById("canvas"));
		// init Canvas
        gr.setOrigin(new jsPoint(w, h)); 
        gr.setCoordinateSystem("cartecian"); 
        gr.showGrid(range, false);	
        
        // mark center "0"
        gr.drawText("0",new jsPoint(0,0),font, new jsColor("gray"));
        
        
       
    }
    
    var position1;
    function drawCoordinate(id, x, y) {
    	
    	if (id == 1) {
    		position1 = new jsPoint(x,y);
        	gr.fillCircle(new jsColor("blue"), position1, 4);
    	} else if (id == 2) {
    		position1 = new jsPoint(x,y);
        	gr.fillCircle(new jsColor("green"), position1, 4);
    	}
    	
    }
   
</script>

</body>
</html>